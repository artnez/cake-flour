<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Flour by ricardobeat</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Flour</h1>
        <p>Bake better Cakefiles</p>

        <p class="view"><a href="https://github.com/ricardobeat/cake-flour">View the Project on GitHub <small>ricardobeat/cake-flour</small></a></p>


        <ul>
          <li><a href="https://github.com/ricardobeat/cake-flour/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/ricardobeat/cake-flour/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/ricardobeat/cake-flour">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>Flour</h1>

<p><strong>Flour</strong> is a set of simple build tools for your Cakefiles.</p>

<p><img src="http://i.imgur.com/yIxF9.jpg" alt="image"></p>

<h2>Usage</h2>

<p><code>npm install flour</code>, don't forget to add it to your <code>package.json</code>. Do <code>require 'flour'</code> at the top of your Cakefile, the tools are added to global scope.</p>

<p>This is what a typical Cakefile could look like:</p>

<pre><code>require 'flour'

task 'lint', 'Check javascript syntax', -&gt;
    lint 'js/feature.js'

task 'build:plugins', -&gt;
    bundle [
        'vendor/underscore.js'
        'vendor/hogan.js'
        'vendor/backbone.js'
    ], 'js/plugins.js'

task 'build:coffee', -&gt;
    compile 'coffee/app.coffee', 'js/app.js'

task 'build:less', -&gt;
    compile 'less/main.less', 'css/main.css'

task 'build', -&gt;
    invoke 'build:plugins'
    invoke 'build:coffee'
    invoke 'build:less

task 'watch', -&gt;
    invoke 'build:less'
    invoke 'build:coffee'

    watch 'less/*.less', -&gt; invoke 'build:less'
    watch 'coffee/app.coffee', -&gt; invoke 'build:coffee'
</code></pre>

<p>(if the global pollution hurts your feelings you can remove them with <code>flour.noConflict()</code>. That will bring the global object back to it's previous state)</p>

<p>Each of these functions can accept either a single file path or an array of files. Simple wildcard paths like <code>*.xxx</code> are also accepted. Example using <code>watch</code> with a list of files:</p>

<pre><code>watch [
    'less/main.less'
    'less/reset.less'
    'less/print.less'
], -&gt; invoke 'build:less'
</code></pre>

<p>You can also access the resulting output by passing a callback:</p>

<pre><code>compile 'coffee/app.coffee', (output) -&gt;
    # do something with the compiled output
    mail.send subject: 'Project file', to: 'grandma@hotmail.com', body: output

# if you don't trust the CS compiler
compile 'coffee/app.coffee', 'js/app.js', -&gt; lint 'js/app.js'
</code></pre>

<h2>Reference</h2>

<h3>Compile</h3>

<p>Compiles LESS and CoffeeScript files:</p>

<pre><code>compile(file, [destination], [callback])
</code></pre>

<h5>Usage</h5>

<pre><code>compile 'app.coffee', 'app.js'

compile 'cold.coffee', 'app.js', (output) -&gt;
    console.log 'Done!'

compile 'cold.coffee', (output) -&gt;
    console.log output.transform()
</code></pre>

<h3>Bundle</h3>

<p>Compile, minify and join a set of files (preserving order):</p>

<pre><code>bundle(files, destination)
</code></pre>

<h5>Usage</h5>

<pre><code>bundle [
    'lib/jquery.js'
    'lib/underscore.js'
    'lib/backbone.js'
], 'js/bundle.js'

bundle 'js/*.js', 'js/all.js'
</code></pre>

<h3>Watch</h3>

<p>Watch files for changes:</p>

<pre><code>watch(files, action)
</code></pre>

<h5>Usage</h5>

<pre><code>watch 'src/app.coffee', -&gt;
    compile 'lib/app.js'

# best used with predefined tasks:

task 'build', -&gt;
    bundle '*.coffee', 'app.js'

task 'watch', -&gt;
    watch [
        'modules.coffee'
        'user.coffee'
        'main.coffee'
    ], -&gt;
        invoke 'build'

# or
watch '*.coffee', -&gt; invoke 'build'
</code></pre>

<h3>Lint</h3>

<p>Check file syntax (uses <a href="http://jshint.com">JSHint</a>):</p>

<pre><code>lint(file, [options], [globals]) # see http://www.jshint.com/options/
</code></pre>

<h4>Usage</h4>

<pre><code>task 'lint', -&gt;

    lint 'scripts/*.js'
</code></pre>

<h3>Minify</h3>

<p>Minify files (currently only Javascript using <a href="https://github.com/mishoo/UglifyJS">UglifyJS</a>):</p>

<pre><code>minify(file, [destination], [callback])
</code></pre>

<h2>Extensibility</h2>

<p>You can add new minifiers and compilers to <code>flour</code>:</p>

<pre><code>flour.minifiers['.stupid'] = (file, cb) -&gt;
    file.read (code) -&gt;
        cb code.replace(/\s*/, '')

flour.compilers['.odd'] = (file, cb) -&gt;
    odd = require 'odd-lib'
    file.read (code) -&gt;
        cb odd.compile code
</code></pre>

<h2>Tricks</h2>

<h4>Disable the JS minifier for development</h4>

<pre><code>task 'watch', -&gt;
    # pass code through unchanged
    flour.minifiers['.js'] = (file, cb) -&gt; cb file.buffer

    # see useful line numbers when debugging!
    watch 'scripts/*.coffee', -&gt; invoke 'build'
</code></pre>

<h4>Pre-compile Hogan templates</h4>

<pre><code>flour.compilers['.mustache'] = (file, cb) -&gt;
    hogan = require 'hogan.js'
    file.read (code) -&gt;
        cb "App.templates['#{file.base}']=${hogan.compile code, asString: true};"

task 'build:templates', -&gt;
    bundle 'views/*.mustache', 'resources/views.js'
</code></pre>

<h2>Why?</h2>

<p>While Grunt, brewerjs, H5BP-build-script and other similar projects have the same (and some more advanced) capabilities, they are increasingly complex. The goal of Flour is to provide a small, short and sane API for the most common build tasks without requiring you to adjust your project structure, install extra tools or create long configuration files. Cake is all you need!</p>

<h4>TODO:</h4>

<ul>
<li>tests</li>
<li>figure out how to magically bundle hogan templates</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/ricardobeat">ricardobeat</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-21731259-4");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>